{"ast":null,"code":";\n\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define(factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.popupS = factory();\n  }\n})(this, function () {\n  'use strict';\n\n  var isOpen = false,\n      queue = []; // Match image file\n\n  var R_IMG = new RegExp(/([^\\/\\\\]+)\\.(jpg|jpeg|png|gif)$/i);\n  var _defaults = {\n    additionalBaseClass: '',\n    additionalButtonHolderClass: '',\n    additionalButtonOkClass: '',\n    additionalButtonCancelClass: '',\n    additionalCloseBtnClass: '',\n    additionalFormClass: '',\n    additionalOverlayClass: '',\n    additionalPopupClass: '',\n    appendLocation: document.body || document.documentElement,\n    baseClassName: 'popupS',\n    closeBtn: '&times;',\n    flagBodyScroll: false,\n    flagButtonReverse: false,\n    flagCloseByEsc: true,\n    flagCloseByOverlay: true,\n    flagShowCloseBtn: true,\n    labelOk: 'OK',\n    labelCancel: 'Cancel',\n    loader: 'spinner',\n    zIndex: 10000\n  };\n\n  var transition = function () {\n    var t, type;\n    var supported = false;\n    var el = document.createElement(\"fakeelement\");\n    var transitions = {\n      \"WebkitTransition\": \"webkitTransitionEnd\",\n      \"MozTransition\": \"transitionend\",\n      \"OTransition\": \"otransitionend\",\n      \"transition\": \"transitionend\"\n    };\n\n    for (t in transitions) {\n      if (transitions.hasOwnProperty(t) && el.style[t] !== undefined) {\n        type = transitions[t];\n        supported = true;\n        break;\n      }\n    }\n\n    return {\n      type: type,\n      supported: supported\n    };\n  }();\n  /**\r\n   * @class   PopupS\r\n   */\n\n\n  function PopupS() {}\n\n  PopupS.prototype = {\n    constructor: PopupS,\n    _open: function (options) {\n      //error catching\n      if (typeof options.mode !== \"string\") throw new Error(\"mode must be a string\");\n      if (typeof options.title !== \"undefined\" && typeof options.title !== \"string\") throw new Error(\"title must be a string\");\n      if (typeof options.placeholder !== \"undefined\" && typeof options.placeholder !== \"string\") throw new Error(\"placeholder must be a string\");\n      this.options = options = _extend({}, options); // Set default options\n\n      for (var name in _defaults) {\n        !(name in options) && (options[name] = _defaults[name]);\n      } // trail all classes divided by periods\n\n\n      _each(['additionalBaseClass', 'additionalButtonHolderClass', 'additionalButtonOkClass', 'additionalButtonCancelClass', 'additionalCloseBtnClass', 'additionalFormClass', 'additionalOverlayClass', 'additionalPopupClass'], function (option) {\n        var string = options[option].split(' ').join('.');\n        options[option] = '.' + string;\n      }); // Bind all private methods\n\n\n      for (var fn in this) {\n        if (fn.charAt(0) === '_') {\n          this[fn] = _bind(this, this[fn]);\n        }\n      } //initialize if it hasn't already been done\n\n\n      this._init(); // if it is forced, close all others\n\n\n      if (options.force === true) {\n        while (queue.length > 0) queue.pop();\n      }\n\n      queue.push(options);\n      if (!isOpen || options.force === true) this._create();\n    },\n    _init: function () {\n      // if i passed a opacity attribute to the layer onClose, remove it on initialization\n      if (this.$layerEl && this.$layerEl.style.opacity) this.$layerEl.style.opacity = \"\";\n\n      if (!this.$wrapEl) {\n        this.$wrapEl = _buildDOM({\n          tag: 'div.' + this.options.baseClassName + '-base' + (this.options.additionalBaseClass ? this.options.additionalBaseClass : ''),\n          css: {\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            position: 'fixed',\n            textAlign: 'center',\n            overflowX: 'auto',\n            overflowY: 'auto',\n            outline: 0,\n            whiteSpace: 'nowrap',\n            zIndex: this.options.zIndex\n          },\n          children: {\n            css: {\n              height: '100%',\n              display: 'inline-block',\n              verticalAlign: 'middle'\n            }\n          }\n        });\n\n        _appendChild(this.$wrapEl, this._getOverlay());\n\n        _appendChild(this.$wrapEl, this._getLayer());\n      }\n    },\n    _getOverlay: function () {\n      if (!this.$overlayEl) {\n        this.$overlayEl = _buildDOM({\n          tag: '#popupS-overlay.' + this.options.baseClassName + '-overlay' + (this.options.additionalOverlayClass ? this.options.additionalOverlayClass : ''),\n          css: {\n            top: 0,\n            right: 0,\n            bottom: 0,\n            left: 0,\n            position: 'fixed',\n            overflowX: 'hidden',\n            userSelect: 'none',\n            webkitUserSelect: 'none',\n            MozUserSelect: 'none'\n          }\n        });\n      }\n\n      this.$overlayEl.setAttribute(\"unselectable\", \"on\");\n      return this.$overlayEl;\n    },\n    _getLayer: function () {\n      if (!this.$layerEl) {\n        this.$layerEl = _buildDOM({\n          css: {\n            display: 'inline-block',\n            position: 'relative',\n            textAlign: 'left',\n            whiteSpace: 'normal',\n            verticalAlign: 'middle',\n            maxWidth: '100%',\n            overflowX: 'hidden',\n            transform: 'translate3d(0,0,0)'\n          },\n          children: {\n            tag: '.' + this.options.baseClassName + '-layer' + (this.options.additionalPopupClass ? this.options.additionalPopupClass : '')\n          }\n        });\n      }\n\n      return this.$layerEl;\n    },\n    _resetLayer: function () {\n      this.$layerEl.childNodes[0].innerHTML = '';\n    },\n\n    /**\r\n     * Takes the first item from the queue\r\n     * creates or overwrites the Overlay and adds Events.\r\n     */\n    _create: function () {\n      var self = this;\n      var item = queue[0];\n      var mode = item.mode;\n      isOpen = true; // Creates the Popup. Overwrites the old one if one exists.\n\n      if (mode != 'modal-ajax') {\n        this._createPopup(item);\n      } else {\n        this._loadContents(item);\n      } // this is very important for the callback function.\n      // these lines make sure callbacks on the same function object will be displayed.\n\n\n      var transitionDone = function (event) {\n        event.stopPropagation();\n\n        _unbind(self.$layerEl, transition.type, transitionDone);\n      };\n\n      if (transition.supported) {\n        _bind(self.$layerEl, transition.type, transitionDone);\n      }\n    },\n    _createPopup: function (item) {\n      var btnOk, btnCancel, htmlObj;\n      var mode = item.mode;\n      var title = item.title;\n      var content = item.content;\n      var className = item.className ? '.' + item.className : '';\n      var contentObj = content instanceof Object ? true : false;\n      this.callbacks = {\n        onOpen: item.onOpen,\n        onSubmit: item.onSubmit,\n        onClose: item.onClose\n      };\n      btnOk = {\n        tag: 'button#popupS-button-ok.' + this.options.baseClassName + '-button-ok' + (this.options.additionalButtonOkClass ? this.options.additionalButtonOkClass : ''),\n        text: this.options.labelOk\n      };\n      btnCancel = {\n        tag: 'button#popupS-button-cancel.' + this.options.baseClassName + '-button-ok' + (this.options.additionalButtonCancelClass ? this.options.additionalButtonCancelClass : ''),\n        text: this.options.labelCancel\n      };\n      htmlObj = [{\n        html: content\n      }, mode != 'modal' && mode != 'modal-ajax' && mode == 'prompt' && {\n        tag: 'form.' + this.options.baseClassName + '-form' + (this.options.additionalFormClass ? this.options.additionalFormClass : ''),\n        children: [item.placeholder && {\n          tag: 'label',\n          htmlFor: 'popupS-input',\n          text: item.placeholder\n        }, {\n          tag: 'input#popupS-input',\n          type: 'text'\n        }]\n      }, mode != 'modal' && mode != 'modal-ajax' && {\n        tag: 'nav.' + this.options.baseClassName + '-buttons' + (this.options.additionalButtonHolderClass ? this.options.additionalButtonHolderClass : ''),\n        children: mode == 'prompt' || mode == 'confirm' ? !this.options.flagButtonReverse ? [btnCancel, btnOk] : [btnOk, btnCancel] : [btnOk]\n      }];\n      content = _buildDOM({\n        children: [{\n          tag: 'a#popupS-resetFocusBack.' + this.options.baseClassName + '-resetFocus',\n          href: '#',\n          text: 'Reset Focus'\n        }, this.options.flagShowCloseBtn && {\n          tag: 'span#popupS-close.' + this.options.baseClassName + '-close' + (this.options.additionalCloseBtnClass ? this.options.additionalCloseBtnClass : ''),\n          html: this.options.closeBtn\n        }, title && {\n          tag: 'h5.' + this.options.baseClassName + '-title' + className,\n          text: title\n        }, {\n          tag: '.' + this.options.baseClassName + '-content' + className,\n          children: contentObj && content || htmlObj\n        }, {\n          tag: 'a#popupS-resetFocus.' + this.options.baseClassName + '-resetFocus',\n          href: '#',\n          text: 'Reset Focus'\n        }]\n      });\n\n      this._resetLayer();\n\n      _appendChild(this.$layerEl.childNodes[0], content);\n\n      this._appendPopup();\n\n      this.$contentEl = this.$layerEl.getElementsByClassName(this.options.baseClassName + '-content')[0];\n      this.$btnReset = document.getElementById('popupS-resetFocus');\n      this.$btnResetBack = document.getElementById('popupS-resetFocusBack'); // handle reset focus link\n      // this ensures that the keyboard focus does not\n      // ever leave the dialog box until an action has\n      // been taken\n\n      _on(this.$btnReset, 'focus', this._resetEvent);\n\n      _on(this.$btnResetBack, 'focus', this._resetEvent); // focus the first input in the layer Element\n\n\n      _autoFocus(this.$layerEl); // make sure which buttons or input fields are defined for the EventListeners\n\n\n      this.$btnOK = document.getElementById('popupS-button-ok') || undefined;\n      this.$btnCancel = document.getElementById('popupS-button-cancel') || undefined;\n      this.$input = document.getElementById('popupS-input') || undefined;\n      if (typeof this.$btnOK !== \"undefined\") _on(this.$btnOK, \"click\", this._okEvent);\n      if (typeof this.$btnCancel !== \"undefined\") _on(this.$btnCancel, \"click\", this._cancelEvent); // eventlisteners for overlay and x\n\n      if (this.options.flagShowCloseBtn) _on(document.getElementById('popupS-close'), \"click\", this._cancelEvent);\n      if (this.options.flagCloseByOverlay) _on(this.$overlayEl, \"click\", this._cancelEvent); // listen for keys\n\n      if (this.options.flagCloseByEsc) _on(document.body, \"keyup\", this._keyEvent); // callback onOpen\n\n      if (typeof this.callbacks.onOpen === \"function\") this.callbacks.onOpen.call(this);\n    },\n    _appendPopup: function () {\n      // Determine the target Element and add the Element to the DOM\n      this.$targetEl = this.options.appendLocation;\n\n      _appendChild(this.$targetEl, this.$wrapEl); // append the element level style for overflow if the option was set.\n\n\n      if (this.$targetEl === (document.body || document.documentElement) && this.options.flagBodyScroll === false) {\n        _css(this.$targetEl, {\n          overflow: 'hidden'\n        });\n      } // after adding elements to the DOM, use computedStyle\n      // to force the browser to recalc and recognize the elements\n      // that we just added. This is so that our CSS Animation has a start point.\n\n\n      if (window.getComputedStyle) window.getComputedStyle(this.$wrapEl, null).height;\n\n      var classReg = function (className) {\n        return new RegExp(\"(|\\\\s+)\" + className + \"(\\\\s+|$)\");\n      }; // if the class *-open doesn't exists in the wrap Element append it.\n\n\n      if (!classReg(' ' + this.options.baseClassName + '-open').test(this.$wrapEl.className)) {\n        this.$wrapEl.className += ' ' + this.options.baseClassName + '-open';\n      }\n\n      if (!classReg(' ' + this.options.baseClassName + '-open').test(this.$layerEl.childNodes[0].className)) {\n        this.$layerEl.childNodes[0].className += ' ' + this.options.baseClassName + '-open';\n      }\n    },\n    _hide: function () {\n      var self = this; // remove item from queue\n\n      queue.splice(0, 1); // check if last item in queue\n\n      if (queue.length > 0) this._create();else {\n        isOpen = false;\n\n        var removeWrap = function () {\n          // remove the wrap element from the DOM\n          _removeElement(self.$wrapEl); // remove the element level style for overflow if the option was set.\n\n\n          if (self.$targetEl === (document.body || document.documentElement) && self.options.flagBodyScroll === false) {\n            if (self.$targetEl.style.removeProperty) {\n              self.$targetEl.style.removeProperty('overflow');\n            } else {\n              self.$targetEl.style.removeAttribute('overflow');\n            }\n          }\n        };\n\n        var transitionDone = function (event) {\n          event.stopPropagation(); // unbind event so function only gets called once\n\n          _off(self.$wrapEl, transition.type, transitionDone); // remove the Element from the DOM after Transition is Done\n\n\n          removeWrap();\n        };\n\n        var transitionDoneLayer = function (event) {\n          event.stopPropagation(); // unbind event so function only gets called once\n\n          _off(self.$layerEl, transition.type, transitionDone);\n        }; // removes the open class from the wrap & layer Element\n        // and adds an EventListener to this Element\n        // which removes it from the DOM after the Transition is done.\n\n\n        this.$wrapEl.className = this.$wrapEl.className.replace(' ' + this.options.baseClassName + '-open', '');\n\n        if (transition.supported) {\n          _on(self.$wrapEl, transition.type, transitionDone);\n        } else {\n          removeWrap();\n        }\n\n        this.$layerEl.childNodes[0].className = this.$layerEl.childNodes[0].className.replace(' ' + this.options.baseClassName + '-open', '');\n        if (transition.supported) _on(self.$layerEl, transition.type, transitionDoneLayer);\n      }\n    },\n    ///////////////\n    //// Async ////\n    ///////////////\n\n    /**\r\n     * sets the state of the loading Layer\r\n     * and appends it to the Dom\r\n     *\r\n     * @param   {Bool}  state\r\n     */\n    _loading: function (state) {\n      this.$loadingEl = _buildDOM({\n        tag: 'div.' + this.options.baseClassName + '-loading.' + this.options.loader\n      });\n\n      if (state) {\n        this._resetLayer();\n\n        _css(this.$layerEl.childNodes[0], {\n          height: '60px',\n          width: '60px',\n          borderRadius: '30px'\n        });\n\n        _appendChild(this.$layerEl.childNodes[0], this.$loadingEl);\n\n        this._appendPopup();\n      } else {\n        _css(this.$layerEl.childNodes[0], {\n          height: null,\n          width: null,\n          borderRadius: null\n        });\n      }\n    },\n\n    /**\r\n     * load Asynchronous Files\r\n     * can be Images or Files via Ajax\r\n     *\r\n     * @param   {Object}    item\r\n     */\n    _loadContents: function (item) {\n      var url = item.ajax.url,\n          str = typeof item.ajax.str != \"undefined\" ? item.ajax.str : '',\n          post = typeof item.ajax.post != \"undefined\" ? item.ajax.post : true,\n          self = this; // Match image file\n\n      if (url.match(R_IMG)) {\n        //.exec(url) !== null\n        // Create the image Element, not visible\n        var imgElement = _buildDOM({\n          children: {\n            tag: 'img',\n            src: url\n          }\n        });\n\n        this._loading(true);\n\n        this._preLoadImage(imgElement, function () {\n          self._loading(false);\n\n          item.content = imgElement;\n\n          self._createPopup(item);\n        });\n      } else {\n        // get url via ajax\n        this._ajax(url, str, post, function (e) {\n          // turn the result in a HTMLElement\n          var ajaxElement = _buildDOM({\n            html: this\n          }); // check if the newly created HTMLElement got any Images within it.\n\n\n          self._preLoadImage(ajaxElement, function () {\n            self._loading(false);\n\n            item.content = ajaxElement;\n\n            self._createPopup(item);\n          });\n        }, function () {\n          //before Sending\n          self._loading(true);\n        });\n      }\n    },\n    _preLoadImage: function (parentNode, callback) {\n      var items = _getElementsByTagName(parentNode, 'img');\n\n      var i = items.length;\n      var queue = i;\n      var img;\n      var self = this;\n\n      while (i--) {\n        img = items[i]; //in case the're already cached by the browser decrement queue\n\n        if (img.complete) {\n          queue--;\n        } else {\n          _on(img, 'load', complete);\n\n          _on(img, 'error', complete);\n        }\n      } //in case the're already cached by the browser\n\n\n      !queue && complete();\n\n      var complete = function () {\n        if (--queue <= 0) {\n          i = items.length;\n\n          while (i--) {\n            img = items[i];\n\n            _off(img, 'load', complete);\n\n            _off(img, 'error', complete);\n          }\n\n          callback();\n        }\n      };\n    },\n\n    /**\r\n     * ajax request\r\n     * with callback and beforeSend\r\n     *\r\n     * @param   {String}    filename\r\n     * @param   {String}    str\r\n     * @param   {Bool}      post\r\n     * @param   {Function}  callback\r\n     * @param   {Function}  beforeSend\r\n     */\n    _ajax: function (filename, str, post, callback, beforeSend) {\n      var ajax;\n\n      if (window.XMLHttpRequest) {\n        ajax = new XMLHttpRequest(); //IE7+, Firefox, Chrome, Opera, Safari\n      } else if (ActiveXObject(\"Microsoft.XMLHTTP\")) {\n        ajax = new ActiveXObject(\"Microsoft.XMLHTTP\"); //IE6/5\n      } else if (ActiveXObject(\"Msxml2.XMLHTTP\")) {\n        ajax = new ActiveXObject(\"Msxml2.XMLHTTP\"); //other\n      } else {\n        alert(\"Error: Your browser does not support AJAX.\");\n        return false;\n      }\n\n      ajax.onreadystatechange = function () {\n        if (ajax.readyState == 4 && ajax.status == 200) {\n          if (callback) callback.call(ajax.responseText);\n        }\n      };\n\n      if (post === false) {\n        ajax.open(\"GET\", filename + str, true);\n        ajax.send(null);\n      } else {\n        ajax.open(\"POST\", filename, true);\n        ajax.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n        ajax.send(str);\n      }\n\n      if (beforeSend) beforeSend.call();\n      return ajax;\n    },\n    ////////////////\n    //// Events ////\n    ////////////////\n    //ok event handler\n    _okEvent: function (event) {\n      // preventDefault\n      if (typeof event.preventDefault !== \"undefined\") event.preventDefault(); // call the callback onSubmit if one is defined. this references to _popupS\n\n      if (typeof this.callbacks.onSubmit === \"function\") {\n        if (typeof this.$input !== \"undefined\") {\n          this.callbacks.onSubmit.call(this, this.$input.value);\n        } else {\n          this.callbacks.onSubmit.call(this);\n        }\n      } // hide popup and detach event handlers\n\n\n      this._commonEvent();\n    },\n    // cancel event handler\n    _cancelEvent: function (event) {\n      if (typeof event.preventDefault !== \"undefined\") event.preventDefault(); // call the callback onClose if one is defined. this references to _popupS\n\n      if (typeof this.callbacks.onClose === \"function\") {\n        this.callbacks.onClose.call(this);\n      }\n\n      this._commonEvent();\n    },\n    // common event handler (keyup, ok and cancel)\n    _commonEvent: function () {\n      // remove event handlers\n      if (typeof this.$btnOK !== \"undefined\") _off(this.$btnOK, \"click\", this._okEvent);\n      if (typeof this.$btnCancel !== \"undefined\") _off(this.$btnCancel, \"click\", this._cancelEvent);\n      if (this.options.flagShowCloseBtn) _off(document.getElementById('popupS-close'), \"click\", this._cancelEvent);\n      if (this.options.flagCloseByOverlay) _off(this.$overlayEl, \"click\", this._cancelEvent);\n      if (this.options.flagCloseByEsc) _off(document.body, \"keyup\", this._keyEvent);\n\n      this._hide();\n    },\n    // reset focus to first item in the popup\n    _resetEvent: function (event) {\n      _autoFocus(this.$layerEl);\n    },\n    // keyEvent Listener for Enter and Escape\n    _keyEvent: function (event) {\n      var keyCode = event.keyCode;\n      if (typeof this.$input !== \"undefined\" && keyCode === 13) this._okEvent(event);\n      if (keyCode === 27) this._cancelEvent(event);\n    }\n  };\n  /**\r\n   * context binding\r\n   * @param   {Function}  ctx     context\r\n   * @param   {Function}  fn      function\r\n   */\n\n  function _bind(ctx, fn) {\n    var args = [].slice.call(arguments, 2);\n    return fn.bind ? fn.bind.apply(fn, [ctx].concat(args)) : function () {\n      return fn.apply(ctx, args.concat([].slice.call(arguments)));\n    };\n  }\n  /**\r\n   * Object iterator\r\n   *\r\n   * @param  {Object|Array}  obj\r\n   * @param  {Function}      iterator\r\n   */\n\n\n  function _each(obj, iterator) {\n    if (obj) {\n      for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          iterator(obj[key], key, obj);\n        }\n      }\n    }\n  }\n  /**\r\n   * Copy all of the properties in the source objects over to the destination object\r\n   *\r\n   * @param   {...Object}     out\r\n   *\r\n   * @return  {Object}\r\n   */\n\n\n  function _extend(out) {\n    out = out || {};\n\n    for (var i = 1; i < arguments.length; i++) {\n      if (!arguments[i]) continue;\n\n      for (var key in arguments[i]) {\n        if (arguments[i].hasOwnProperty(key)) out[key] = arguments[i][key];\n      }\n    }\n\n    return out;\n  }\n  /**\r\n   * Bind events to elements\r\n   *\r\n   * @param  {HTMLElement}    el\r\n   * @param  {Event}          event\r\n   * @param  {Function}       fn\r\n   */\n\n\n  function _on(el, event, fn) {\n    if (typeof el.addEventListener === \"function\") {\n      el.addEventListener(event, fn, false);\n    } else if (el.attachEvent) {\n      el.attachEvent(\"on\" + event, fn);\n    }\n  }\n  /**\r\n   * Unbind events from element\r\n   *\r\n   * @param  {HTMLElement}    el\r\n   * @param  {Event}          event\r\n   * @param  {Function}       fn\r\n   */\n\n\n  function _off(el, event, fn) {\n    if (typeof el.removeEventListener === \"function\") {\n      el.removeEventListener(event, fn, false);\n    } else if (el.detachEvent) {\n      el.detachEvent(\"on\" + event, fn);\n    }\n  }\n  /**\r\n   * css recursion\r\n   *\r\n   * @param   {HTMLElement}   el\r\n   * @param   {Object|String} prop\r\n   * @param   {String}        [val]\r\n   */\n\n\n  function _css(el, prop, val) {\n    if (el && el.style && prop) {\n      if (prop instanceof Object) {\n        for (var name in prop) {\n          _css(el, name, prop[name]);\n        }\n      } else {\n        el.style[prop] = val;\n      }\n    }\n  }\n  /**\r\n   * Selector RegExp\r\n   *\r\n   * @const   {RegExp}\r\n   */\n  // orig: /^(\\w+)?(#\\w+)?((?:\\.[\\w_-]+)*)/i;\n\n\n  var R_SELECTOR = /^(\\w+)?(#[\\w_-]+)?((?:\\.[\\w_-]+)*)/i;\n  /**\r\n   * build DOM Nodes\r\n   *\r\n   * @example\r\n   *  _buildDOM({\r\n   *      tag:'div#id.class.class2',\r\n   *      css:{\r\n   *          opacity:'1',\r\n   *          width:'100px'\r\n   *      },\r\n   *      text:'test',\r\n   *      html:'<p>Hello</p>',\r\n   *      children:[{\r\n   *          tag:'div#id_child.class.class2',\r\n   *          css:{opacity:'1', height:'200px'},\r\n   *          text:'test',\r\n   *          html:'<p>World</p>'\r\n   *      }]\r\n   *  });\r\n   *\r\n   * @param   {String|Object} spec\r\n   *\r\n   * @return  {HTMLElement}\r\n   */\n\n  function _buildDOM(spec) {\n    // Spec Defaults\n    if (spec === null) {\n      spec = 'div';\n    }\n\n    if (typeof spec === 'string') {\n      spec = {\n        tag: spec\n      };\n    }\n\n    var el, classSelector;\n    var fragment = document.createDocumentFragment();\n    var children = spec.children;\n    var selector = R_SELECTOR.exec(spec.tag || '');\n    delete spec.children;\n    spec.tag = selector[1] || 'div';\n    spec.id = spec.id || (selector[2] || '').substr(1); // split ClassNames\n\n    classSelector = (selector[3] || '').split('.');\n    classSelector[0] = spec.className || '';\n    spec.className = classSelector.join(' ');\n    el = document.createElement(spec.tag);\n\n    _appendChild(fragment, el);\n\n    delete spec.tag; // For every\n    // key => spec[key];\n\n    _each(spec, function (value, key) {\n      if (key === 'css') {\n        _css(el, spec.css);\n      } else if (key === 'text') {\n        value !== null && _appendChild(el, document.createTextNode(value));\n      } else if (key === 'html') {\n        value !== null && (el.innerHTML = value);\n      } else if (key in el) {\n        try {\n          el[key] = value;\n        } catch (e) {\n          el.setAttribute(key, value);\n        }\n      } else if (/^data-/.test(key)) {\n        el.setAttribute(key, value);\n      }\n    }); // if the children is already an HTML Element, append it to el\n\n\n    if (children && children.appendChild) {\n      _appendChild(el, children);\n    } else if (children) {\n      if (children instanceof Array) {\n        _each(children, function (value, key) {\n          if (value instanceof Object) {\n            _appendChild(el, _buildDOM(value));\n          }\n        });\n      } else if (children instanceof Object) {\n        _appendChild(el, _buildDOM(children));\n      }\n    }\n\n    return el;\n  }\n  /**\r\n   * appendChild\r\n   *\r\n   * @param   {HTMLElement}   parent\r\n   * @param   {HTMLElement}   el\r\n   */\n\n\n  function _appendChild(parent, el) {\n    try {\n      parent && el && parent.appendChild(el);\n    } catch (e) {}\n  }\n  /**\r\n   * Focus First Item in Parent Node\r\n   * submit > text,password > button\r\n   *\r\n   * @param  {HTMLElement}    parentNode\r\n   */\n\n\n  function _autoFocus(parentNode) {\n    var items = _getElementsByTagName(parentNode, 'input');\n\n    var i = 0;\n    var n = items.length;\n    var el, element;\n\n    for (; i < n; i++) {\n      el = items[i];\n\n      if (el.type === 'submit') {\n        !element && (element = el);\n      } else if (!/hidden|check|radio/.test(el.type) && el.value === '') {\n        element = el;\n        break;\n      }\n    }\n\n    if (!element) {\n      element = _getElementsByTagName(parentNode, 'button')[0];\n    }\n\n    try {\n      element.focus();\n    } catch (err) {}\n  }\n  /**\r\n   * get Elements with Tag () from Parent\r\n   *\r\n   * @param   {HTMLElement}  el\r\n   * @param   {String}       name\r\n   *\r\n   * @return  {NodeList}\r\n   */\n\n\n  function _getElementsByTagName(el, name) {\n    return el.getElementsByTagName(name);\n  }\n  /**\r\n   * remove Element from Parent\r\n   *\r\n   * @param   {HTMLElement}   el\r\n   */\n\n\n  function _removeElement(el) {\n    if (el && el.parentNode) {\n      el.parentNode.removeChild(el);\n    }\n  } // Instantiate a PopupS Object\n\n\n  var popupS = new PopupS(); // Public methods\n\n  popupS.window = function (params) {\n    this._open(params);\n  };\n\n  popupS.alert = function (params) {\n    params = _extend(params, {\n      mode: 'alert'\n    });\n\n    this._open(params);\n  };\n\n  popupS.confirm = function (params) {\n    params = _extend(params, {\n      mode: 'confirm'\n    });\n\n    this._open(params);\n  };\n\n  popupS.prompt = function (params) {\n    params = _extend(params, {\n      mode: 'prompt'\n    });\n\n    this._open(params);\n  };\n\n  popupS.modal = function (params) {\n    params = _extend(params, {\n      mode: 'modal'\n    });\n\n    this._open(params);\n  };\n\n  popupS.ajax = function (params) {\n    params = _extend(params, {\n      mode: 'modal-ajax'\n    });\n\n    this._open(params);\n  }; // Export\n\n\n  return popupS;\n});","map":{"version":3,"sources":["E:/Zero to mastery/Apps Developed/facedetector/node_modules/popups/dist/popupS.js"],"names":["root","factory","define","amd","exports","module","popupS","isOpen","queue","R_IMG","RegExp","_defaults","additionalBaseClass","additionalButtonHolderClass","additionalButtonOkClass","additionalButtonCancelClass","additionalCloseBtnClass","additionalFormClass","additionalOverlayClass","additionalPopupClass","appendLocation","document","body","documentElement","baseClassName","closeBtn","flagBodyScroll","flagButtonReverse","flagCloseByEsc","flagCloseByOverlay","flagShowCloseBtn","labelOk","labelCancel","loader","zIndex","transition","t","type","supported","el","createElement","transitions","hasOwnProperty","style","undefined","PopupS","prototype","constructor","_open","options","mode","Error","title","placeholder","_extend","name","_each","option","string","split","join","fn","charAt","_bind","_init","force","length","pop","push","_create","$layerEl","opacity","$wrapEl","_buildDOM","tag","css","top","left","right","bottom","position","textAlign","overflowX","overflowY","outline","whiteSpace","children","height","display","verticalAlign","_appendChild","_getOverlay","_getLayer","$overlayEl","userSelect","webkitUserSelect","MozUserSelect","setAttribute","maxWidth","transform","_resetLayer","childNodes","innerHTML","self","item","_createPopup","_loadContents","transitionDone","event","stopPropagation","_unbind","btnOk","btnCancel","htmlObj","content","className","contentObj","Object","callbacks","onOpen","onSubmit","onClose","text","html","htmlFor","href","_appendPopup","$contentEl","getElementsByClassName","$btnReset","getElementById","$btnResetBack","_on","_resetEvent","_autoFocus","$btnOK","$btnCancel","$input","_okEvent","_cancelEvent","_keyEvent","call","$targetEl","_css","overflow","window","getComputedStyle","classReg","test","_hide","splice","removeWrap","_removeElement","removeProperty","removeAttribute","_off","transitionDoneLayer","replace","_loading","state","$loadingEl","width","borderRadius","url","ajax","str","post","match","imgElement","src","_preLoadImage","_ajax","e","ajaxElement","parentNode","callback","items","_getElementsByTagName","i","img","complete","filename","beforeSend","XMLHttpRequest","ActiveXObject","alert","onreadystatechange","readyState","status","responseText","open","send","setRequestHeader","preventDefault","value","_commonEvent","keyCode","ctx","args","slice","arguments","bind","apply","concat","obj","iterator","key","out","addEventListener","attachEvent","removeEventListener","detachEvent","prop","val","R_SELECTOR","spec","classSelector","fragment","createDocumentFragment","selector","exec","id","substr","createTextNode","appendChild","Array","parent","n","element","focus","err","getElementsByTagName","removeChild","params","confirm","prompt","modal"],"mappings":"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","sourcesContent":[";(function (root, factory) {\r\n\r\n    if (typeof define === 'function' && define.amd) {\r\n        define(factory);\r\n    } else if (typeof exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        root.popupS = factory();\r\n    }\r\n\r\n}(this, function () {\r\n    'use strict';\r\n\r\n    var isOpen = false,\r\n        queue  = [];\r\n\r\n    // Match image file\r\n    var R_IMG = new RegExp( /([^\\/\\\\]+)\\.(jpg|jpeg|png|gif)$/i );\r\n\r\n    var _defaults = {\r\n        additionalBaseClass: '',\r\n        additionalButtonHolderClass: '',\r\n        additionalButtonOkClass: '',\r\n        additionalButtonCancelClass: '',\r\n        additionalCloseBtnClass: '',\r\n        additionalFormClass: '',\r\n        additionalOverlayClass: '',\r\n        additionalPopupClass: '',\r\n        appendLocation: (document.body || document.documentElement),\r\n        baseClassName: 'popupS',\r\n        closeBtn: '&times;',\r\n        flagBodyScroll: false,\r\n        flagButtonReverse: false,\r\n        flagCloseByEsc: true,\r\n        flagCloseByOverlay: true,\r\n        flagShowCloseBtn: true,\r\n        labelOk: 'OK',\r\n        labelCancel: 'Cancel',\r\n        loader: 'spinner',\r\n        zIndex: 10000\r\n    }\r\n\r\n    var transition = (function() {\r\n        var t, type;\r\n        var supported = false;\r\n        var el = document.createElement(\"fakeelement\");\r\n        var transitions = {\r\n            \"WebkitTransition\": \"webkitTransitionEnd\",\r\n            \"MozTransition\": \"transitionend\",\r\n            \"OTransition\": \"otransitionend\",\r\n            \"transition\": \"transitionend\"\r\n        };\r\n\r\n        for(t in transitions) {\r\n            if (transitions.hasOwnProperty(t) && el.style[t] !== undefined) {\r\n                type = transitions[t];\r\n                supported = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        return {\r\n            type: type,\r\n            supported: supported\r\n        };\r\n    })()\r\n\r\n    /**\r\n     * @class   PopupS\r\n     */\r\n    function PopupS() {}\r\n\r\n    PopupS.prototype = {\r\n        constructor: PopupS,\r\n\r\n        _open: function(options) {\r\n            //error catching\r\n            if (typeof options.mode !== \"string\") throw new Error(\"mode must be a string\");\r\n            if (typeof options.title !== \"undefined\" && typeof options.title !== \"string\") throw new Error(\"title must be a string\");\r\n            if (typeof options.placeholder !== \"undefined\" && typeof options.placeholder !== \"string\") throw new Error(\"placeholder must be a string\");\r\n\r\n            this.options = options = _extend({}, options);\r\n\r\n            // Set default options\r\n            for (var name in _defaults) {\r\n                !(name in options) && (options[name] = _defaults[name]);\r\n            }\r\n\r\n            // trail all classes divided by periods\r\n            _each(['additionalBaseClass', 'additionalButtonHolderClass', 'additionalButtonOkClass', 'additionalButtonCancelClass', 'additionalCloseBtnClass', 'additionalFormClass', 'additionalOverlayClass', 'additionalPopupClass'], function(option) {\r\n                var string = options[option].split(' ').join('.');\r\n                options[option] = '.' + string;\r\n            });\r\n\r\n            // Bind all private methods\r\n            for (var fn in this) {\r\n                if (fn.charAt(0) === '_') {\r\n                    this[fn] = _bind(this, this[fn]);\r\n                }\r\n            }\r\n\r\n            //initialize if it hasn't already been done\r\n            this._init();\r\n\r\n            // if it is forced, close all others\r\n            if(options.force === true) {\r\n                while (queue.length > 0) queue.pop();\r\n            }\r\n            queue.push(options);\r\n\r\n            if(!isOpen || options.force === true) this._create();\r\n        },\r\n        _init: function() {\r\n            // if i passed a opacity attribute to the layer onClose, remove it on initialization\r\n            if(this.$layerEl && this.$layerEl.style.opacity) this.$layerEl.style.opacity = \"\";\r\n            if(!this.$wrapEl){\r\n                this.$wrapEl = _buildDOM({\r\n                    tag: 'div.' + this.options.baseClassName + '-base' + (this.options.additionalBaseClass ? this.options.additionalBaseClass : ''),\r\n                    css: {\r\n                        top: 0,\r\n                        left: 0,\r\n                        right: 0,\r\n                        bottom: 0,\r\n                        position: 'fixed',\r\n                        textAlign: 'center',\r\n                        overflowX: 'auto',\r\n                        overflowY: 'auto',\r\n                        outline: 0,\r\n                        whiteSpace: 'nowrap',\r\n                        zIndex: this.options.zIndex\r\n                    },\r\n                    children: {\r\n                        css: {\r\n                            height: '100%',\r\n                            display: 'inline-block',\r\n                            verticalAlign: 'middle'\r\n                        }\r\n                    }\r\n                });\r\n                _appendChild(this.$wrapEl, this._getOverlay());\r\n                _appendChild(this.$wrapEl, this._getLayer());\r\n            }\r\n        },\r\n        _getOverlay: function () {\r\n            if (!this.$overlayEl) {\r\n                this.$overlayEl = _buildDOM({\r\n                    tag: '#popupS-overlay.' + this.options.baseClassName + '-overlay' + (this.options.additionalOverlayClass ? this.options.additionalOverlayClass : ''),\r\n                    css: {\r\n                        top: 0,\r\n                        right: 0,\r\n                        bottom: 0,\r\n                        left: 0,\r\n                        position: 'fixed',\r\n                        overflowX: 'hidden',\r\n                        userSelect: 'none',\r\n                        webkitUserSelect: 'none',\r\n                        MozUserSelect: 'none'\r\n                    }\r\n                });\r\n            }\r\n            this.$overlayEl.setAttribute(\"unselectable\", \"on\");\r\n            return this.$overlayEl;\r\n        },\r\n        _getLayer: function () {\r\n            if(!this.$layerEl){\r\n                this.$layerEl = _buildDOM({\r\n                    css: {\r\n                        display: 'inline-block',\r\n                        position: 'relative',\r\n                        textAlign: 'left',\r\n                        whiteSpace: 'normal',\r\n                        verticalAlign: 'middle',\r\n                        maxWidth: '100%',\r\n                        overflowX: 'hidden',\r\n                        transform: 'translate3d(0,0,0)'\r\n                    },\r\n                    children: {\r\n                        tag: '.' + this.options.baseClassName + '-layer' + (this.options.additionalPopupClass ? this.options.additionalPopupClass : '')\r\n                    }\r\n                });\r\n            }\r\n            return this.$layerEl;\r\n        },\r\n        _resetLayer: function(){\r\n            this.$layerEl.childNodes[0].innerHTML = '';\r\n        },\r\n        /**\r\n         * Takes the first item from the queue\r\n         * creates or overwrites the Overlay and adds Events.\r\n         */\r\n        _create: function () {\r\n            var self = this;\r\n            var item = queue[0];\r\n            var mode = item.mode;\r\n            isOpen = true;\r\n            // Creates the Popup. Overwrites the old one if one exists.\r\n            if (mode != 'modal-ajax') {\r\n                this._createPopup(item);\r\n            } else {\r\n                this._loadContents(item);\r\n            }\r\n            // this is very important for the callback function.\r\n            // these lines make sure callbacks on the same function object will be displayed.\r\n            var transitionDone = function(event) {\r\n                event.stopPropagation();\r\n                _unbind(self.$layerEl, transition.type, transitionDone);\r\n            };\r\n            if(transition.supported){\r\n                _bind(self.$layerEl, transition.type, transitionDone);\r\n            }\r\n        },\r\n        _createPopup: function(item) {\r\n            var btnOk, btnCancel, htmlObj;\r\n            var mode        = item.mode;\r\n            var title       = item.title;\r\n            var content     = item.content;\r\n            var className   = (item.className ? '.' + item.className : '');\r\n            var contentObj  = ((content instanceof Object) ? true : false);\r\n\r\n            this.callbacks = {\r\n                onOpen: item.onOpen,\r\n                onSubmit: item.onSubmit,\r\n                onClose: item.onClose\r\n            };\r\n\r\n            btnOk = {\r\n                tag:  'button#popupS-button-ok.' + this.options.baseClassName + '-button-ok' + (this.options.additionalButtonOkClass ? this.options.additionalButtonOkClass : ''),\r\n                text: this.options.labelOk };\r\n            btnCancel = {\r\n                tag:  'button#popupS-button-cancel.' + this.options.baseClassName + '-button-ok' + (this.options.additionalButtonCancelClass ? this.options.additionalButtonCancelClass : ''),\r\n                text: this.options.labelCancel };\r\n\r\n            htmlObj = [\r\n                { html: content },\r\n                mode != 'modal' && mode != 'modal-ajax' && mode == 'prompt' && {\r\n                    tag: 'form.' + this.options.baseClassName + '-form' + (this.options.additionalFormClass ? this.options.additionalFormClass : ''),\r\n                    children: [\r\n                        item.placeholder && { tag:     'label',\r\n                          htmlFor: 'popupS-input',\r\n                          text:    item.placeholder },\r\n                        { tag:  'input#popupS-input',\r\n                          type: 'text' }\r\n                    ]\r\n                },\r\n                mode != 'modal' && mode != 'modal-ajax' && { tag: 'nav.' + this.options.baseClassName + '-buttons' + (this.options.additionalButtonHolderClass ? this.options.additionalButtonHolderClass : ''),\r\n                  children:\r\n                    (\r\n                        (mode == 'prompt' || mode == 'confirm')\r\n                            ? (!this.options.flagButtonReverse ? [btnCancel, btnOk] : [btnOk, btnCancel] )\r\n                            : [btnOk]\r\n                    )\r\n                }\r\n            ];\r\n\r\n            content = _buildDOM({\r\n                children:[\r\n                    { tag: 'a#popupS-resetFocusBack.' + this.options.baseClassName + '-resetFocus',\r\n                      href:'#',\r\n                      text:'Reset Focus' },\r\n                    (this.options.flagShowCloseBtn && {\r\n                        tag: 'span#popupS-close.' + this.options.baseClassName + '-close' + (this.options.additionalCloseBtnClass ? this.options.additionalCloseBtnClass : ''),\r\n                        html: this.options.closeBtn\r\n                    }),\r\n                    (title && {\r\n                        tag:  'h5.' + this.options.baseClassName + '-title' + className,\r\n                        text: title }),\r\n                    { tag:      '.' + this.options.baseClassName + '-content' + className,\r\n                      children: (contentObj && content || htmlObj) },\r\n                    { tag:'a#popupS-resetFocus.' + this.options.baseClassName + '-resetFocus',\r\n                      href:'#',\r\n                      text:'Reset Focus'}\r\n                ]\r\n            });\r\n\r\n            this._resetLayer();\r\n            _appendChild(this.$layerEl.childNodes[0], content);\r\n            this._appendPopup();\r\n            this.$contentEl = this.$layerEl.getElementsByClassName(this.options.baseClassName + '-content')[0];\r\n\r\n            this.$btnReset     = document.getElementById('popupS-resetFocus');\r\n            this.$btnResetBack = document.getElementById('popupS-resetFocusBack');\r\n\r\n            // handle reset focus link\r\n            // this ensures that the keyboard focus does not\r\n            // ever leave the dialog box until an action has\r\n            // been taken\r\n            _on(this.$btnReset, 'focus', this._resetEvent);\r\n            _on(this.$btnResetBack, 'focus', this._resetEvent);\r\n\r\n            // focus the first input in the layer Element\r\n            _autoFocus(this.$layerEl);\r\n\r\n            // make sure which buttons or input fields are defined for the EventListeners\r\n            this.$btnOK = document.getElementById('popupS-button-ok') || undefined;\r\n            this.$btnCancel = document.getElementById('popupS-button-cancel') || undefined;\r\n            this.$input = document.getElementById('popupS-input') || undefined;\r\n            if(typeof this.$btnOK !== \"undefined\")     _on(this.$btnOK, \"click\", this._okEvent);\r\n            if(typeof this.$btnCancel !== \"undefined\") _on(this.$btnCancel, \"click\", this._cancelEvent);\r\n\r\n\r\n            // eventlisteners for overlay and x\r\n            if (this.options.flagShowCloseBtn)   _on(document.getElementById('popupS-close'), \"click\", this._cancelEvent);\r\n            if (this.options.flagCloseByOverlay) _on(this.$overlayEl, \"click\", this._cancelEvent);\r\n\r\n            // listen for keys\r\n            if (this.options.flagCloseByEsc) _on(document.body, \"keyup\", this._keyEvent);\r\n\r\n            // callback onOpen\r\n            if(typeof this.callbacks.onOpen === \"function\") this.callbacks.onOpen.call(this);\r\n\r\n        },\r\n        _appendPopup : function(){\r\n            // Determine the target Element and add the Element to the DOM\r\n            this.$targetEl = this.options.appendLocation;\r\n            _appendChild(this.$targetEl, this.$wrapEl);\r\n            // append the element level style for overflow if the option was set.\r\n            if ((this.$targetEl === (document.body || document.documentElement)) && this.options.flagBodyScroll === false) {\r\n                _css(this.$targetEl, {\r\n                    overflow: 'hidden'\r\n                });\r\n            }\r\n            // after adding elements to the DOM, use computedStyle\r\n            // to force the browser to recalc and recognize the elements\r\n            // that we just added. This is so that our CSS Animation has a start point.\r\n            if(window.getComputedStyle) window.getComputedStyle(this.$wrapEl, null).height;\r\n            var classReg = function (className) {\r\n                return new RegExp(\"(|\\\\s+)\" + className + \"(\\\\s+|$)\");\r\n            };\r\n            // if the class *-open doesn't exists in the wrap Element append it.\r\n            if (!(classReg(' ' + this.options.baseClassName + '-open').test(this.$wrapEl.className))) {\r\n                this.$wrapEl.className += ' ' + this.options.baseClassName + '-open';\r\n            }\r\n            if (!(classReg(' ' + this.options.baseClassName + '-open').test(this.$layerEl.childNodes[0].className))) {\r\n                this.$layerEl.childNodes[0].className += ' ' + this.options.baseClassName + '-open';\r\n            }\r\n        },\r\n        _hide: function () {\r\n            var self = this;\r\n            // remove item from queue\r\n            queue.splice(0,1);\r\n            // check if last item in queue\r\n            if (queue.length > 0) this._create();\r\n            else{\r\n                isOpen = false;\r\n\r\n                var removeWrap = function() {\r\n                    // remove the wrap element from the DOM\r\n                    _removeElement(self.$wrapEl);\r\n                    // remove the element level style for overflow if the option was set.\r\n                    if ((self.$targetEl === (document.body || document.documentElement)) && self.options.flagBodyScroll === false) {\r\n                        if (self.$targetEl.style.removeProperty) {\r\n                            self.$targetEl.style.removeProperty('overflow');\r\n                        } else {\r\n                            self.$targetEl.style.removeAttribute('overflow');\r\n                        }\r\n                    }\r\n                };\r\n\r\n                var transitionDone = function(event) {\r\n                    event.stopPropagation();\r\n                    // unbind event so function only gets called once\r\n                    _off(self.$wrapEl, transition.type, transitionDone);\r\n                    // remove the Element from the DOM after Transition is Done\r\n                    removeWrap();\r\n                };\r\n\r\n                var transitionDoneLayer = function(event) {\r\n                    event.stopPropagation();\r\n                    // unbind event so function only gets called once\r\n                    _off(self.$layerEl, transition.type, transitionDone);\r\n                };\r\n\r\n                // removes the open class from the wrap & layer Element\r\n                // and adds an EventListener to this Element\r\n                // which removes it from the DOM after the Transition is done.\r\n\r\n                this.$wrapEl.className = this.$wrapEl.className.replace(' ' + this.options.baseClassName + '-open', '');\r\n                if (transition.supported){\r\n                    _on(self.$wrapEl, transition.type, transitionDone);\r\n                } else {\r\n                    removeWrap();\r\n                }\r\n                this.$layerEl.childNodes[0].className = this.$layerEl.childNodes[0].className.replace(' ' + this.options.baseClassName + '-open', '');\r\n                if (transition.supported) _on(self.$layerEl, transition.type, transitionDoneLayer);\r\n\r\n            }\r\n        },\r\n\r\n\r\n\r\n        ///////////////\r\n        //// Async ////\r\n        ///////////////\r\n\r\n\r\n        /**\r\n         * sets the state of the loading Layer\r\n         * and appends it to the Dom\r\n         *\r\n         * @param   {Bool}  state\r\n         */\r\n        _loading: function(state) {\r\n            this.$loadingEl = _buildDOM({\r\n                tag: 'div.' + this.options.baseClassName + '-loading.' + this.options.loader\r\n            });\r\n            if (state){\r\n                this._resetLayer();\r\n                _css(this.$layerEl.childNodes[0],{\r\n                    height: '60px',\r\n                    width: '60px',\r\n                    borderRadius: '30px'\r\n                });\r\n                _appendChild(this.$layerEl.childNodes[0], this.$loadingEl);\r\n                this._appendPopup();\r\n            } else {\r\n                _css(this.$layerEl.childNodes[0],{\r\n                    height: null,\r\n                    width: null,\r\n                    borderRadius: null\r\n                });\r\n            }\r\n        },\r\n        /**\r\n         * load Asynchronous Files\r\n         * can be Images or Files via Ajax\r\n         *\r\n         * @param   {Object}    item\r\n         */\r\n        _loadContents: function(item) {\r\n            var url = item.ajax.url,\r\n                str = (typeof item.ajax.str != \"undefined\")? item.ajax.str : '',\r\n                post = (typeof item.ajax.post != \"undefined\")? item.ajax.post : true,\r\n                self = this;\r\n\r\n            // Match image file\r\n            if (url.match(R_IMG)) {//.exec(url) !== null\r\n                // Create the image Element, not visible\r\n                var imgElement = _buildDOM({\r\n                    children: {\r\n                        tag :   'img',\r\n                        src :   url\r\n                    }\r\n                });\r\n                this._loading(true);\r\n                this._preLoadImage(imgElement, function(){\r\n                    self._loading(false);\r\n                    item.content = imgElement;\r\n                    self._createPopup(item);\r\n                });\r\n            } else {\r\n                // get url via ajax\r\n                this._ajax(url, str, post, function(e){\r\n                    // turn the result in a HTMLElement\r\n                    var ajaxElement = _buildDOM({\r\n                        html: this\r\n                    });\r\n                    // check if the newly created HTMLElement got any Images within it.\r\n                    self._preLoadImage(ajaxElement, function(){\r\n                        self._loading(false);\r\n                        item.content = ajaxElement;\r\n                        self._createPopup(item);\r\n                    });\r\n                }, function(){\r\n                    //before Sending\r\n                    self._loading(true);\r\n                });\r\n            }\r\n        },\r\n        _preLoadImage : function(parentNode, callback) {\r\n            var items = _getElementsByTagName(parentNode, 'img');\r\n            var i = items.length;\r\n            var queue = i;\r\n            var img;\r\n            var self = this;\r\n\r\n            while (i--){\r\n                img = items[i];\r\n                //in case the're already cached by the browser decrement queue\r\n                if(img.complete) {\r\n                    queue--;\r\n                } else {\r\n                    _on(img, 'load', complete);\r\n                    _on(img, 'error', complete);\r\n                }\r\n            }\r\n            //in case the're already cached by the browser\r\n            !queue && complete();\r\n\r\n            var complete = function(){\r\n                if(--queue <= 0){\r\n                    i = items.length;\r\n                    while(i--){\r\n                        img = items[i];\r\n                        _off(img, 'load', complete);\r\n                        _off(img, 'error', complete);\r\n                    }\r\n                    callback();\r\n                }\r\n            };\r\n        },\r\n        /**\r\n         * ajax request\r\n         * with callback and beforeSend\r\n         *\r\n         * @param   {String}    filename\r\n         * @param   {String}    str\r\n         * @param   {Bool}      post\r\n         * @param   {Function}  callback\r\n         * @param   {Function}  beforeSend\r\n         */\r\n        _ajax: function(filename, str, post, callback, beforeSend) {\r\n            var ajax;\r\n            if (window.XMLHttpRequest){\r\n                ajax = new XMLHttpRequest();//IE7+, Firefox, Chrome, Opera, Safari\r\n            } else if (ActiveXObject(\"Microsoft.XMLHTTP\")){\r\n                ajax = new ActiveXObject(\"Microsoft.XMLHTTP\");//IE6/5\r\n            }else if (ActiveXObject(\"Msxml2.XMLHTTP\")){\r\n                ajax = new ActiveXObject(\"Msxml2.XMLHTTP\");//other\r\n            }else{\r\n                alert(\"Error: Your browser does not support AJAX.\");\r\n                return false;\r\n            }\r\n            ajax.onreadystatechange=function(){\r\n                if (ajax.readyState == 4 && ajax.status == 200){\r\n                    if (callback) callback.call(ajax.responseText);\r\n                }\r\n            };\r\n            if(post === false) {\r\n                ajax.open(\"GET\", filename + str, true);\r\n                ajax.send(null);\r\n            } else {\r\n                ajax.open(\"POST\", filename, true);\r\n                ajax.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\r\n                ajax.send(str);\r\n            }\r\n            if(beforeSend) beforeSend.call();\r\n            return ajax;\r\n        },\r\n\r\n\r\n\r\n        ////////////////\r\n        //// Events ////\r\n        ////////////////\r\n\r\n\r\n\r\n        //ok event handler\r\n        _okEvent: function(event) {\r\n            // preventDefault\r\n            if (typeof event.preventDefault !== \"undefined\") event.preventDefault();\r\n            // call the callback onSubmit if one is defined. this references to _popupS\r\n            if(typeof this.callbacks.onSubmit === \"function\") {\r\n                if(typeof this.$input !== \"undefined\") {\r\n                    this.callbacks.onSubmit.call(this, this.$input.value);\r\n                } else {\r\n                    this.callbacks.onSubmit.call(this);\r\n                }\r\n            }\r\n            // hide popup and detach event handlers\r\n            this._commonEvent();\r\n        },\r\n        // cancel event handler\r\n        _cancelEvent: function(event) {\r\n            if (typeof event.preventDefault !== \"undefined\") event.preventDefault();\r\n            // call the callback onClose if one is defined. this references to _popupS\r\n            if(typeof this.callbacks.onClose === \"function\") {\r\n                this.callbacks.onClose.call(this);\r\n            }\r\n            this._commonEvent();\r\n        },\r\n        // common event handler (keyup, ok and cancel)\r\n        _commonEvent: function() {\r\n            // remove event handlers\r\n            if(typeof this.$btnOK !== \"undefined\")     _off(this.$btnOK, \"click\", this._okEvent);\r\n            if(typeof this.$btnCancel !== \"undefined\") _off(this.$btnCancel, \"click\", this._cancelEvent);\r\n            if (this.options.flagShowCloseBtn)   _off(document.getElementById('popupS-close'), \"click\", this._cancelEvent);\r\n            if (this.options.flagCloseByOverlay) _off(this.$overlayEl, \"click\", this._cancelEvent);\r\n            if (this.options.flagCloseByEsc)     _off(document.body, \"keyup\", this._keyEvent);\r\n\r\n            this._hide();\r\n        },\r\n        // reset focus to first item in the popup\r\n        _resetEvent: function(event) {\r\n            _autoFocus(this.$layerEl);\r\n        },\r\n        // keyEvent Listener for Enter and Escape\r\n        _keyEvent: function(event) {\r\n            var keyCode = event.keyCode;\r\n            if(typeof this.$input !== \"undefined\" && keyCode === 13) this._okEvent(event);\r\n            if(keyCode === 27) this._cancelEvent(event);\r\n        },\r\n\r\n    }\r\n\r\n    /**\r\n     * context binding\r\n     * @param   {Function}  ctx     context\r\n     * @param   {Function}  fn      function\r\n     */\r\n    function _bind(ctx, fn) {\r\n        var args = [].slice.call(arguments, 2);\r\n        return  fn.bind ? fn.bind.apply(fn, [ctx].concat(args)) : function () {\r\n            return fn.apply(ctx, args.concat([].slice.call(arguments)));\r\n        };\r\n    }\r\n    /**\r\n     * Object iterator\r\n     *\r\n     * @param  {Object|Array}  obj\r\n     * @param  {Function}      iterator\r\n     */\r\n    function _each(obj, iterator) {\r\n        if (obj) {\r\n            for (var key in obj) {\r\n                if (obj.hasOwnProperty(key)) {\r\n                    iterator(obj[key], key, obj);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Copy all of the properties in the source objects over to the destination object\r\n     *\r\n     * @param   {...Object}     out\r\n     *\r\n     * @return  {Object}\r\n     */\r\n    function _extend(out) {\r\n        out = out || {};\r\n\r\n        for (var i = 1; i < arguments.length; i++) {\r\n            if (!arguments[i])\r\n                continue;\r\n\r\n            for (var key in arguments[i]) {\r\n                if (arguments[i].hasOwnProperty(key))\r\n                    out[key] = arguments[i][key];\r\n            }\r\n        }\r\n\r\n        return out;\r\n    }\r\n    /**\r\n     * Bind events to elements\r\n     *\r\n     * @param  {HTMLElement}    el\r\n     * @param  {Event}          event\r\n     * @param  {Function}       fn\r\n     */\r\n    function _on(el, event, fn) {\r\n        if (typeof el.addEventListener === \"function\") {\r\n            el.addEventListener(event, fn, false);\r\n        } else if (el.attachEvent) {\r\n            el.attachEvent(\"on\" + event, fn);\r\n        }\r\n    }\r\n    /**\r\n     * Unbind events from element\r\n     *\r\n     * @param  {HTMLElement}    el\r\n     * @param  {Event}          event\r\n     * @param  {Function}       fn\r\n     */\r\n    function _off(el, event, fn) {\r\n        if (typeof el.removeEventListener === \"function\") {\r\n            el.removeEventListener(event, fn, false);\r\n        } else if (el.detachEvent) {\r\n            el.detachEvent(\"on\" + event, fn);\r\n        }\r\n    }\r\n    /**\r\n     * css recursion\r\n     *\r\n     * @param   {HTMLElement}   el\r\n     * @param   {Object|String} prop\r\n     * @param   {String}        [val]\r\n     */\r\n    function _css(el, prop, val) {\r\n        if (el && el.style && prop) {\r\n            if (prop instanceof Object) {\r\n                for (var name in prop) {\r\n                    _css(el, name, prop[name]);\r\n                }\r\n            } else {\r\n                el.style[prop] = val;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * Selector RegExp\r\n     *\r\n     * @const   {RegExp}\r\n     */\r\n    // orig: /^(\\w+)?(#\\w+)?((?:\\.[\\w_-]+)*)/i;\r\n    var R_SELECTOR = /^(\\w+)?(#[\\w_-]+)?((?:\\.[\\w_-]+)*)/i;\r\n\r\n    /**\r\n     * build DOM Nodes\r\n     *\r\n     * @example\r\n     *  _buildDOM({\r\n     *      tag:'div#id.class.class2',\r\n     *      css:{\r\n     *          opacity:'1',\r\n     *          width:'100px'\r\n     *      },\r\n     *      text:'test',\r\n     *      html:'<p>Hello</p>',\r\n     *      children:[{\r\n     *          tag:'div#id_child.class.class2',\r\n     *          css:{opacity:'1', height:'200px'},\r\n     *          text:'test',\r\n     *          html:'<p>World</p>'\r\n     *      }]\r\n     *  });\r\n     *\r\n     * @param   {String|Object} spec\r\n     *\r\n     * @return  {HTMLElement}\r\n     */\r\n    function _buildDOM(spec) {\r\n        // Spec Defaults\r\n        if (spec === null) {\r\n            spec = 'div';\r\n        }\r\n        if (typeof spec === 'string') {\r\n            spec = {\r\n                tag: spec\r\n            };\r\n        }\r\n        var el, classSelector;\r\n        var fragment = document.createDocumentFragment();\r\n        var children = spec.children;\r\n        var selector = R_SELECTOR.exec(spec.tag || '');\r\n\r\n        delete spec.children;\r\n\r\n        spec.tag = selector[1] || 'div';\r\n        spec.id = spec.id || (selector[2] || '').substr(1);\r\n        // split ClassNames\r\n        classSelector = (selector[3] || '').split('.');\r\n        classSelector[0] = (spec.className || '');\r\n        spec.className = classSelector.join(' ');\r\n\r\n\r\n        el = document.createElement(spec.tag);\r\n        _appendChild(fragment, el);\r\n        delete spec.tag;\r\n\r\n        // For every\r\n        // key => spec[key];\r\n        _each(spec, function(value, key) {\r\n            if (key === 'css') {\r\n                _css(el, spec.css);\r\n            } else if (key === 'text') {\r\n                (value !== null) && _appendChild(el, document.createTextNode(value));\r\n            } else if (key === 'html') {\r\n                (value !== null) && (el.innerHTML = value);\r\n            } else if (key in el) {\r\n                try {\r\n                    el[key] = value;\r\n                } catch (e) {\r\n                    el.setAttribute(key, value);\r\n                }\r\n            } else if (/^data-/.test(key)) {\r\n                el.setAttribute(key, value);\r\n            }\r\n        });\r\n        // if the children is already an HTML Element, append it to el\r\n        if (children && children.appendChild) {\r\n            _appendChild(el, children);\r\n        } else if (children) {\r\n            if (children instanceof Array) {\r\n                _each(children, function(value, key) {\r\n                    if(value instanceof Object) {\r\n                        _appendChild(el, _buildDOM(value));\r\n                    }\r\n                });\r\n            } else if (children instanceof Object) {\r\n                _appendChild(el, _buildDOM(children));\r\n            }\r\n        }\r\n        return el;\r\n    }\r\n    /**\r\n     * appendChild\r\n     *\r\n     * @param   {HTMLElement}   parent\r\n     * @param   {HTMLElement}   el\r\n     */\r\n    function _appendChild(parent, el) {\r\n        try {\r\n            parent && el && parent.appendChild(el);\r\n        } catch (e) {}\r\n    }\r\n    /**\r\n     * Focus First Item in Parent Node\r\n     * submit > text,password > button\r\n     *\r\n     * @param  {HTMLElement}    parentNode\r\n     */\r\n    function _autoFocus(parentNode) {\r\n        var items = _getElementsByTagName(parentNode, 'input');\r\n        var i = 0;\r\n        var n = items.length;\r\n        var el, element;\r\n\r\n        for (; i < n; i++) {\r\n            el = items[i];\r\n\r\n            if (el.type === 'submit') {\r\n                !element && (element = el);\r\n            } else if (!/hidden|check|radio/.test(el.type) && el.value === '') {\r\n                element = el;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (!element) {\r\n            element = _getElementsByTagName(parentNode, 'button')[0];\r\n        }\r\n\r\n        try {\r\n            element.focus();\r\n        } catch (err) {}\r\n    }\r\n    /**\r\n     * get Elements with Tag () from Parent\r\n     *\r\n     * @param   {HTMLElement}  el\r\n     * @param   {String}       name\r\n     *\r\n     * @return  {NodeList}\r\n     */\r\n    function _getElementsByTagName(el, name) {\r\n        return el.getElementsByTagName(name);\r\n    }\r\n    /**\r\n     * remove Element from Parent\r\n     *\r\n     * @param   {HTMLElement}   el\r\n     */\r\n    function _removeElement(el) {\r\n        if (el && el.parentNode) {\r\n            el.parentNode.removeChild(el);\r\n        }\r\n    }\r\n\r\n    // Instantiate a PopupS Object\r\n    var popupS = new PopupS();\r\n\r\n    // Public methods\r\n    popupS.window = function(params) {\r\n        this._open(params);\r\n    };\r\n    popupS.alert = function(params) {\r\n        params = _extend(params, {mode: 'alert'});\r\n        this._open(params);\r\n    };\r\n    popupS.confirm = function(params) {\r\n        params = _extend(params, {mode: 'confirm'});\r\n        this._open(params);\r\n    };\r\n    popupS.prompt = function(params) {\r\n        params = _extend(params, {mode: 'prompt'});\r\n        this._open(params);\r\n    };\r\n    popupS.modal = function(params) {\r\n        params = _extend(params, {mode: 'modal'});\r\n        this._open(params);\r\n    };\r\n    popupS.ajax = function(params) {\r\n        params = _extend(params, {mode: 'modal-ajax'});\r\n        this._open(params);\r\n    };\r\n\r\n    // Export\r\n    return popupS;\r\n}));"]},"metadata":{},"sourceType":"script"}